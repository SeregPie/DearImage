!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.PaperDuck=t()}(this,function(){"use strict";var e=function(e){this.context=e},t={canvas:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};function n(n){for(var r=[],e=arguments.length-1;0<e--;)r[e]=arguments[e+1];return function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return n.call.apply(n,[this].concat(r,e))}}t.canvas.get=function(){return this.context.canvas},t.width.get=function(){return this.canvas.width},t.height.get=function(){return this.canvas.height},Object.defineProperties(e.prototype,t),e.blank=function(e,t){return new this(this.blankContext(e,t))},e.blankCanvas=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n=this.createCanvas();return n.width=e,n.height=t,n},e.blankContext=function(e,t){return this.blankCanvas(e,t).getContext("2d")},e.createCanvas=function(){return document.createElement("canvas")},e.from=function(){return(e=value)&&"object"==typeof e?value.canvas instanceof HTMLCanvasElement?this.fromImageSource(value.canvas):this.fromImageSource(value):this.blank();var e},e.fromImageSource=function(e){var t=e.naturalWidth||e.width,n=e.naturalHeight||e.height,r=this.blankContext(t,n);return r.drawImage(e,0,0),new this(r)},e.load=function(e){var t=this;return Promise.try(function(){return"string"==typeof e?t.loadString(e):e instanceof HTMLImageElement?t.loadImage(e):e instanceof HTMLInputElement?t.loadInput(e):e instanceof File?t.loadFile(e):e instanceof FileReader?t.loadFileReader(e):t.from(e)})},e.loadFile=function(t){var n=this;return Promise.try(function(){var e=new FileReader;return e.readAsDataURL(t),n.loadFileReader(e)})},e.loadFileReader=function(a){var e=this;return Promise.try(function(){return 1<a.readyState?e.load(a.result):new Promise(function(e,t){n=e,r=t,a.addEventListener("load",n),a.addEventListener("error",r)}).then(function(){return e.load(a.result)}).finally(function(){a.removeEventListener("load",n),a.removeEventListener("error",r)});var n,r})},e.loadImage=function(a){var e=this;return Promise.try(function(){return a.complete?e.fromImageSource(a):new Promise(function(e,t){n=e,r=t,a.addEventListener("load",n),a.addEventListener("error",r)}).then(function(){return e.fromImageSource(a)}).finally(function(){a.removeEventListener("load",n),a.removeEventListener("error",r)});var n,r})},e.loadInput=function(e){var t=this;return Promise.try(function(){return"file"===e.type?0<e.files.length?t.loadFile(e.files[0]):t.blank():t.load(e.value)})},e.loadString=function(t){var n=this;return Promise.try(function(){var e=new Image;return e.crossOrigin="anonymous",e.src=t,n.loadImage(e)})};var r=function(e,t){var n=this.width,r=this.height;if(0===n||0===r)return this;var a=this.constructor.blankContext(n,r);return a.translate(e?n:0,t?r:0),a.scale(e?-1:1,t?-1:1),a.drawImage(this.canvas,0,0),new this.constructor(a)};return e.prototype.flop=n(r,!0,!1),e.prototype.flip=n(r,!1,!0),e.prototype.rotate180=n(r,!0,!0),e.prototype.resize=function(){},e});
